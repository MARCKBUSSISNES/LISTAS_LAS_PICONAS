<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TORTILLAS DE HARINA LAS PICONAS</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
<style>
body {
  font-family: 'Arial', sans-serif;
  background:#121212;
  color:#fff;
  margin:0;
  padding:0;
}
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:20px;
  background:#000;
}
#logo{
  width:450px;
  height:auto;
}
header h1{
  font-size:2rem;
  color:#25D366;
  text-align:center;
  flex:1;
}
.container{
  max-width:900px;
  margin:auto;
  padding:20px;
}
.form-group{
  display:flex;
  gap:10px;
  margin-bottom:12px;
  flex-wrap:wrap;
}
select, input{
  padding:10px;
  border-radius:8px;
  border:none;
  font-size:1rem;
  flex:1;
}
input[type=number]{width:100px;}
button{
  padding:12px 18px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-weight:bold;
  font-size:1rem;
}
#addBtn{background:#25D366;color:#fff;}
#sendJuanBtn{background:#000;color:#25D366;}
#resetBtn{background:#e74c3c;color:#fff;}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
}
table, th, td{border:1px solid #444;}
th, td{padding:6px; text-align:center; font-size:1.1rem;}
label{font-size:0.9rem;}
footer{
  text-align:center;
  margin-top:20px;
  color:#888;
  font-size:0.9rem;
}
</style>
</head>
<body>

<header>
  <img src="LOGO1 (2).png" alt="Logo" id="logo">
  <h1>TORTILLAS DE HARINA LAS PICONAS</h1>
  <div id="currentDate"></div>
</header>

<div class="container">
  <div class="form-group">
    <input type="text" id="productName" placeholder="Nombre del producto">
    <input type="number" id="productQty" placeholder="Cantidad">
    <input type="text" id="productUnit" placeholder="Unidad de medida">
    <select id="productSupplier">
      <option value="">Proveedor</option>
      <option value="PP">PP</option>
      <option value="AP">AP</option>
      <option value="SC">SC</option>
      <option value="RS">RS</option>
      <option value="TERM">TERM</option>
      <option value="PRC">PRC</option>
    </select>
    <button id="addBtn">Agregar</button>
  </div>

  <table id="itemsTable">
    <thead>
      <tr>
        <th>Producto</th>
        <th>Cantidad</th>
        <th>Unidad</th>
        <th>Proveedor</th>
        <th>Recibido</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="form-group" style="margin-top:15px;">
    <input type="text" id="operator" placeholder="Quién realiza el procedimiento">
    <select id="branch">
      <option value="">Sucursal</option>
      <option value="Roosevelt">Roosevelt</option>
      <option value="SanCristobal">San Cristobal</option>
    </select>
    <button id="generatePDF">Generar PDF</button>
    <button id="sendJuanBtn">Enviar a Juan Luis</button>
    <button id="resetBtn">Reiniciar todo</button>
  </div>
</div>

<footer>
  MarckBusiness © 2025 — Todos los derechos reservados
</footer>

<script>
const items = [];
const tbody = document.querySelector('#itemsTable tbody');
const currentDateEl = document.getElementById('currentDate');

function updateDate(){
  const now = new Date();
  currentDateEl.textContent = now.toLocaleString();
}
updateDate();
setInterval(updateDate, 1000);

function renderTable(){
  tbody.innerHTML='';
  items.forEach(it=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${it.name}</td><td>${it.qty}</td><td>${it.unit}</td><td>${it.supplier}</td><td></td>`;
    tbody.appendChild(tr);
  });
}

document.getElementById('addBtn').addEventListener('click', ()=>{
  const name = document.getElementById('productName').value.trim();
  const qty = document.getElementById('productQty').value;
  const unit = document.getElementById('productUnit').value.trim();
  const supplier = document.getElementById('productSupplier').value;
  if(!name || !qty || !supplier){ alert('Complete todos los campos'); return; }
  items.push({name, qty, unit, supplier});
  renderTable();
  document.getElementById('productName').value='';
  document.getElementById('productQty').value='';
  document.getElementById('productUnit').value='';
  document.getElementById('productName').focus();
});

document.getElementById('productName').addEventListener('keypress', (e)=>{
  if(e.key==='Enter'){ document.getElementById('addBtn').click(); }
});

document.getElementById('generatePDF').addEventListener('click', ()=>{
  if(items.length===0){ alert('No hay productos'); return; }
  const operator = document.getElementById('operator').value.trim();
  const branch = document.getElementById('branch').value;
  if(!branch){ alert('Seleccione sucursal'); return; }
  if(!operator){ alert('Ingrese quién realiza el procedimiento'); return; }

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({unit:'mm', format:[80,3000]});
  let y=10;

  const logoImg = new Image();
  logoImg.src='LOGO1 (2).png';
  logoImg.onload = ()=>{
    doc.addImage(logoImg,'PNG',10,y,60,35);
    y+=38;

    const now = new Date();
    doc.setFontSize(10);
    doc.text(`Sucursal: ${branch}`, 40, y, {align:'center'});
    doc.text(`Fecha: ${now.toLocaleDateString()} ${now.toLocaleTimeString()}`,70,10,{align:'right'});
    y+=6;
    doc.text(`Quién realiza: ${operator}`,40,y,{align:'center'});
    y+=6;

    doc.autoTable({
      startY: y,
      theme:'grid',
      head: [['Producto','Cantidad','Unidad','Proveedor','Recibido']],
      body: items.map(it=>[it.name,it.qty,it.unit,it.supplier,'[ ]']),
      styles:{ fontSize:9, cellPadding:1 },
      margin:{left:5,right:5}
    });

    y = doc.lastAutoTable.finalY + 10;

    // Texto Se recibe correctamente y cuadros SI / NO
    doc.setFontSize(10);
    doc.text('Se reciben correctamente todos los productos:',40,y,{align:'center'});
    y+=6;
    doc.rect(20,y,6,6); doc.text('SI',28,y+5);
    doc.rect(45,y,6,6); doc.text('NO',53,y+5);

    doc.save('ListaProductos.pdf');
  }
});

document.getElementById('sendJuanBtn').addEventListener('click', ()=>{
  window.open('https://wa.me/58140621','_blank');
});

document.getElementById('resetBtn').addEventListener('click', ()=>{
  if(confirm('¿Desea reiniciar todo?')) {
    items.length=0;
    renderTable();
    document.getElementById('productName').value='';
    document.getElementById('productQty').value='';
    document.getElementById('productUnit').value='';
    document.getElementById('operator').value='';
    document.getElementById('branch').value='';
  }
});
</script>
</body>
</html>
