<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generador de Listas</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
body {
  font-family: 'Arial', sans-serif;
  background:#121212;
  color:#fff;
  margin:0;
  padding:0;
}
header{
  text-align:center;
  padding:20px 0;
  background:#000;
}
#logo{
  width:300px;
  height:auto;
}
.container{
  max-width:900px;
  margin:auto;
  padding:20px;
}
.form-group{
  display:flex;
  gap:10px;
  margin-bottom:12px;
  flex-wrap:wrap;
}
select, input{
  padding:10px;
  border-radius:8px;
  border:none;
  font-size:1rem;
  flex:1;
}
input[type=number]{width:100px;}
button{
  padding:12px 18px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-weight:bold;
  font-size:1rem;
}
#addBtn{background:#25D366;color:#fff;}
#sendJuanBtn{background:#000;color:#25D366;}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
}
table, th, td{border:1px solid #444;}
th, td{padding:6px; text-align:center; font-size:1.1rem;}
</style>
</head>
<body>

<header>
  <img src="LOGO1 (2).png" alt="Logo" id="logo">
</header>

<div class="container">
  <div class="form-group">
    <input type="text" id="productName" placeholder="Nombre del producto">
    <input type="number" id="productQty" placeholder="Cantidad">
    <input type="text" id="productUnit" placeholder="Unidad de medida">
    <select id="productSupplier">
      <option value="">Proveedor</option>
      <option value="PP">PP</option>
      <option value="AP">AP</option>
      <option value="SC">SC</option>
      <option value="RS">RS</option>
      <option value="TERM">TERM</option>
      <option value="PRC">PRC</option>
    </select>
    <button id="addBtn">Agregar</button>
  </div>

  <table id="itemsTable">
    <thead>
      <tr>
        <th>Producto</th>
        <th>Cantidad</th>
        <th>Unidad</th>
        <th>Proveedor</th>
        <th>Recibido</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="form-group" style="margin-top:15px;">
    <select id="branch">
      <option value="">Sucursal</option>
      <option value="Roosevelt">Roosevelt</option>
      <option value="SanCristobal">San Cristobal</option>
    </select>
    <button id="generatePDF">Generar PDF</button>
    <button id="sendJuanBtn">Enviar a Juan Luis</button>
  </div>
</div>

<script>
const items = [];
const tbody = document.querySelector('#itemsTable tbody');

function renderTable(){
  tbody.innerHTML='';
  items.forEach(it=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${it.name}</td><td>${it.qty}</td><td>${it.unit}</td><td>${it.supplier}</td><td></td>`;
    tbody.appendChild(tr);
  });
}

document.getElementById('addBtn').addEventListener('click', ()=>{
  const name = document.getElementById('productName').value.trim();
  const qty = document.getElementById('productQty').value;
  const unit = document.getElementById('productUnit').value.trim();
  const supplier = document.getElementById('productSupplier').value;
  if(!name || !qty || !supplier){ alert('Complete todos los campos'); return; }
  items.push({name, qty, unit, supplier});
  renderTable();
  document.getElementById('productName').value='';
  document.getElementById('productQty').value='';
  document.getElementById('productUnit').value='';
  document.getElementById('productName').focus();
});

document.getElementById('productName').addEventListener('keypress', (e)=>{
  if(e.key==='Enter'){ document.getElementById('addBtn').click(); }
});

document.getElementById('generatePDF').addEventListener('click', ()=>{
  if(items.length===0){ alert('No hay productos'); return; }
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({unit:'mm', format:[80,3000]});
  let y=10;

  const branch = document.getElementById('branch').value;
  if(!branch){ alert('Seleccione sucursal'); return; }

  const today = new Date();
  const fecha = today.toLocaleDateString() + ' ' + today.toLocaleTimeString();

  const logoImg = new Image();
  logoImg.src='LOGO1 (2).png';
  logoImg.onload = ()=>{
    doc.addImage(logoImg,'PNG',15,y,50,30);
    y+=35;

    doc.setFontSize(12);
    doc.text(`Sucursal: ${branch}`, 40, y, {align:'center'});
    y+=6;
    doc.text(`Fecha: ${fecha}`, 40, y, {align:'center'});
    y+=10;

    // TÃ­tulo "Se reciben correctamente..."
    doc.setFontSize(10);
    doc.text('Se reciben correctamente todos los productos', 40, y, {align:'center'});
    y+=6;

    // Cabecera tabla
    doc.autoTable({
      startY: y,
      theme:'grid',
      head: [['Producto','Cantidad','Unidad','Proveedor','Recibido']],
      body: items.map(it=>[it.name,it.qty,it.unit,it.supplier,'']),
      styles:{ fontSize:9, cellPadding:1 },
      margin:{left:5,right:5}
    });

    y = doc.lastAutoTable.finalY + 10;

    // Observaciones
    doc.text('Observaciones:',40,y,{align:'center'}); y+=6;
    doc.text('_______________________',40,y,{align:'center'}); y+=8;
    doc.text('_______________________',40,y,{align:'center'}); y+=8;
    doc.text('_______________________',40,y,{align:'center'}); y+=12;

    // Firmas
    doc.text('Firma de quien recibe:',40,y,{align:'center'}); y+=6;
    doc.text('_______________________',40,y,{align:'center'}); y+=8;
    doc.text('Nombre de quien recibe:',40,y,{align:'center'}); y+=6;
    doc.text('_______________________',40,y,{align:'center'}); y+=8;
    doc.text('Firma de quien entrega:',40,y,{align:'center'}); y+=6;
    doc.text('_______________________',40,y,{align:'center'}); y+=8;

    doc.save('ListaProductos.pdf');
  }
});

document.getElementById('sendJuanBtn').addEventListener('click', ()=>{
  window.open('https://wa.me/58140621','_blank');
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
</body>
</html>
