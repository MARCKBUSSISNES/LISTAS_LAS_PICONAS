<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TORTILLAS DE HARINA LAS PICONAS</title>
<style>
:root {
    --bg: #121212;
    --accent: #00ff00;
    --white: #ffffff;
    --dark: #000000;
}
* {margin:0;padding:0;box-sizing:border-box;font-family:'Courier New', monospace;}
body {background:var(--bg);color:var(--white);padding:20px;}
header {text-align:center;margin-bottom:20px;}
header img {width:250px;display:block;margin:0 auto;}
.container {max-width:1200px;margin:auto;}
table {width:100%;border-collapse:collapse;margin-bottom:10px;}
th, td {border:1px solid var(--white);padding:8px;text-align:center;font-size:1.2rem;}
input, select {padding:10px;font-size:1rem;border-radius:6px;border:none;}
button {padding:12px 20px;font-size:1rem;border:none;border-radius:8px;cursor:pointer;}
#btnEnviar {background:var(--dark);color:var(--accent);}
#btnReiniciar {background:#e74c3c;color:#fff;}
</style>
</head>
<body>

<header>
    <img src="LOGO1 (2).png" alt="Logo">
    <div id="fechaHora" style="text-align:right;font-size:0.9rem;margin-top:5px;"></div>
</header>

<div class="container">
    <div>
        <label>Proveedor:</label>
        <select id="proveedor">
            <option value="PP">PP</option>
            <option value="AP">AP</option>
            <option value="SC">SC</option>
            <option value="RS">RS</option>
            <option value="TERM">TERM</option>
            <option value="PRC">PRC</option>
        </select>

        <label>Producto:</label>
        <input type="text" id="producto">

        <label>Unidad de medida:</label>
        <input type="text" id="unidad" placeholder="Ej: Kg, Litros...">

        <label>Cantidad:</label>
        <input type="number" id="cantidad" min="1" value="1">

        <button id="agregar">Agregar</button>
        <button id="btnReiniciar">Reiniciar todo</button>
    </div>

    <table id="tablaProductos">
        <thead>
            <tr>
                <th>Producto</th>
                <th>Cantidad</th>
                <th>Proveedor</th>
                <th>Unidad</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <label>Operador:</label>
    <input type="text" id="operador" placeholder="Quien realiza el procedimiento">

    <button id="generarPDF">Generar PDF</button>
    <button id="btnEnviar">Enviar a Juan Luis</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const { jsPDF } = window.jspdf;

const productos = [];
const tablaBody = document.querySelector("#tablaProductos tbody");
const productoInput = document.getElementById("producto");
const cantidadInput = document.getElementById("cantidad");
const unidadInput = document.getElementById("unidad");
const proveedorSelect = document.getElementById("proveedor");
const operadorInput = document.getElementById("operador");

function actualizarTabla(){
    tablaBody.innerHTML = '';
    productos.forEach(p=>{
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${p.producto}</td><td>${p.cantidad}</td><td>${p.proveedor}</td><td>${p.unidad}</td>`;
        tablaBody.appendChild(tr);
    });
}

document.getElementById("agregar").addEventListener("click", ()=>{ 
    if(!productoInput.value) return alert("Ingrese un producto");
    productos.push({
        producto: productoInput.value,
        cantidad: cantidadInput.value,
        proveedor: proveedorSelect.value,
        unidad: unidadInput.value
    });
    actualizarTabla();
    productoInput.value='';
    cantidadInput.value='1';
    unidadInput.value='';
    productoInput.focus();
});

productoInput.addEventListener("keypress",(e)=>{
    if(e.key==='Enter'){ document.getElementById("agregar").click(); }
});

document.getElementById("btnReiniciar").addEventListener("click", ()=>{
    if(confirm("¿Desea reiniciar todo?")){ productos.length=0; actualizarTabla(); operadorInput.value=''; }
});

// Fecha y hora actual
function actualizarFechaHora(){
    const now = new Date();
    document.getElementById("fechaHora").textContent = now.toLocaleString();
}
actualizarFechaHora();
setInterval(actualizarFechaHora,1000);

document.getElementById("generarPDF").addEventListener("click", ()=>{
    if(productos.length===0) return alert("No hay productos para generar PDF");
    const doc = new jsPDF({unit:'mm', format:[80,200]});
    const logo = new Image();
    logo.src = "LOGO1 (2).png";
    logo.onload = ()=>{
        doc.addImage(logo,'PNG',15,5,50,25); // ancho y alto del logo
        doc.setFontSize(12);
        doc.text("Sucursal: "+proveedorSelect.value,65,10,{align:'right'});
        doc.text("Operador: "+operadorInput.value,65,18,{align:'right'});
        doc.text("Fecha: "+new Date().toLocaleString(),65,26,{align:'right'});
        let y = 40;
        doc.setFontSize(10);
        doc.text("Listado de productos:",10,y); y+=4;
        doc.autoTable({
            startY: y,
            theme: 'grid',
            head:[['Producto','Cantidad','Proveedor','Unidad']],
            body: productos.map(p=>[p.producto,p.cantidad,p.proveedor,p.unidad]),
            styles:{fontSize:8,cellPadding:1},
            margin:{left:5,right:5}
        });
        const finalY = doc.lastAutoTable.finalY + 5;
        // Observaciones y firmas
        doc.setFontSize(10);
        doc.text("Observaciones:",10,finalY);
        for(let i=0;i<3;i++){ doc.line(10,finalY+3+i*5,70,finalY+3+i*5); }
        let recepcionY = finalY+20;
        doc.text("Firma quien recibe:",10,recepcionY); doc.line(10,recepcionY+3,70,recepcionY+3);
        doc.text("Nombre quien recibe:",10,recepcionY+10); doc.line(10,recepcionY+13,70,recepcionY+13);
        doc.text("Firma quien entrega:",10,recepcionY+20); doc.line(10,recepcionY+23,70,recepcionY+23);
        // SI / NO
        doc.text("Se reciben correctamente todos los productos:",10,recepcionY+35);
        doc.rect(10, recepcionY+38, 6,6); doc.text("SI",18,recepcionY+43);
        doc.rect(28, recepcionY+38,6,6); doc.text("NO",36,recepcionY+43);
        doc.save("Listado_Productos.pdf");
    };
});

// Botón enviar a Juan Luis (WhatsApp)
document.getElementById("btnEnviar").addEventListener("click", ()=>{
    const url = "https://wa.me/58140621";
    window.open(url,'_blank');
});
</script>
</body>
</html>
